<mat-card>
  <mat-card-header style="display: flex; align-items: center;">
    <mat-card-title>Lista de Órdenes</mat-card-title>
    <span class="spacer"></span>
    <button mat-raised-button color="primary" (click)="createNewOrder()">
      <mat-icon>add</mat-icon> Nueva Orden
    </button>
  </mat-card-header>
  <mat-card-content>
    <mat-tab-group (selectedTabChange)="onTabChange($event)">
      <mat-tab label="Entregado">
        <ng-template matTabContent>
          <div class="mat-elevation-z8 table-container">
            <div class="desktop-view">
              <table mat-table [dataSource]="dataSourceCompleted" class="full-width-table" matSort #sortCompleted="matSort">
                <ng-container matColumnDef="id">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header> ID </th>
                  <td mat-cell *matCellDef="let order"> {{ order.id }} </td>
                </ng-container>
                <ng-container matColumnDef="orderDate">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header> F. Orden </th>
                  <td mat-cell *matCellDef="let order"> {{ order.orderDate | date:'dd/MM/yyyy' }} </td>
                </ng-container>
                <ng-container matColumnDef="deliveryDate">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header> F. Entrega </th>
                  <td mat-cell *matCellDef="let order"> {{ order.deliveryDate | date:'dd/MM/yyyy' }} </td>
                </ng-container>
                <ng-container matColumnDef="deliveryAddress">
                  <th mat-header-cell *matHeaderCellDef> Dirección Envío </th>
                  <td mat-cell *matCellDef="let order"> {{ order.deliveryAddress }} </td>
                </ng-container>
                <ng-container matColumnDef="paymentMethod">
                  <th mat-header-cell *matHeaderCellDef> Pago </th>
                  <td mat-cell *matCellDef="let order"> {{ order.paymentMethod }} </td>
                </ng-container>
                <ng-container matColumnDef="notes">
                  <th mat-header-cell *matHeaderCellDef> Notas </th>
                  <td mat-cell *matCellDef="let order"> {{ order.notes }} </td>
                </ng-container>
                <ng-container matColumnDef="totalAmount">
                  <th mat-header-cell *matHeaderCellDef> Total </th>
                  <td mat-cell *matCellDef="let order"> {{ order.totalAmount | currency:'USD' }} </td>
                </ng-container>
                <ng-container matColumnDef="status">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header> Estado </th>
                  <td mat-cell *matCellDef="let order">
                    <span class="estado-badge" [ngClass]="{'entregado': order.status === 'E', 'pendiente': order.status === 'P', 'cancelado': order.status === 'C'}">
                      {{ order.status === 'E' ? 'Entregado' : order.status === 'P' ? 'Pendiente' : 'Cancelado' }}
                    </span>
                  </td>
                </ng-container>
                <ng-container matColumnDef="actions">
                  <th mat-header-cell *matHeaderCellDef> Acciones </th>
                  <td mat-cell *matCellDef="let order">
                    <button mat-icon-button color="primary" (click)="editOrder(order)" matTooltip="Editar">
                      <mat-icon>edit</mat-icon>
                    </button>
                    <button mat-icon-button color="warn" (click)="deleteOrder(order.id)" matTooltip="Eliminar">
                      <mat-icon>delete</mat-icon>
                    </button>
                  </td>
                </ng-container>
                <ng-container matColumnDef="details">
                  <th mat-header-cell *matHeaderCellDef> Detalles </th>
                  <td mat-cell *matCellDef="let order">
                    <button mat-icon-button color="accent" (click)="viewDetails(order)" matTooltip="Ver Detalles">
                      <mat-icon>list_alt</mat-icon>
                    </button>
                  </td>
                </ng-container>
                <ng-container matColumnDef="report">
                  <th mat-header-cell *matHeaderCellDef> Reporte </th>
                  <td mat-cell *matCellDef="let order">
                    <button mat-icon-button color="basic" (click)="generateReport(order.id)" matTooltip="Generar Reporte PDF">
                      <mat-icon>picture_as_pdf</mat-icon>
                    </button>
                  </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
              </table>
              <mat-paginator
                [pageSizeOptions]="[5, 10, 20]"
                showFirstLastButtons
                aria-label="Selector de página"
                #paginatorCompleted
              ></mat-paginator>
              <div *ngIf="dataSourceCompleted.data.length === 0" style="padding: 20px; text-align: center">
                No hay órdenes completadas disponibles.
              </div>
            </div>

            <div class="mobile-view">
              <div class="order-card" *ngFor="let order of dataSourceCompleted.data">
                <div class="card-header">
                  <span class="order-id">Orden #{{ order.id }}</span>
                  <span class="order-status" [ngClass]="{'entregado': order.status === 'E', 'pendiente': order.status === 'P', 'cancelado': order.status === 'C'}">
                    {{ order.status === 'E' ? 'Entregado' : order.status === 'P' ? 'Pendiente' : 'Cancelado' }}
                  </span>
                </div>
                <div class="card-body">
                  <div class="info-item">
                    <span class="info-label">F. Orden:</span>
                    <span class="info-value">{{ order.orderDate | date:'dd/MM/yyyy' }}</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">F. Entrega:</span>
                    <span class="info-value">{{ order.deliveryDate | date:'dd/MM/yyyy' }}</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Total:</span>
                    <span class="info-value">{{ order.totalAmount | currency:'USD' }}</span>
                  </div>
                </div>
                <div class="card-actions">
                  <button mat-button color="primary" (click)="editOrder(order)">
                    <mat-icon>edit</mat-icon> Editar
                  </button>
                  <button mat-button color="warn" (click)="deleteOrder(order.id)">
                    <mat-icon>delete</mat-icon> Eliminar
                  </button>
                  <button mat-button color="accent" (click)="viewDetails(order)">
                    <mat-icon>list_alt</mat-icon> Detalles
                  </button>
                </div>
              </div>
              <div *ngIf="dataSourceCompleted.data.length === 0" style="padding: 20px; text-align: center">
                No hay órdenes completadas disponibles.
              </div>
            </div>
          </div>
        </ng-template>
      </mat-tab>
      <mat-tab label="En Proceso">
        <ng-template matTabContent>
          <div class="mat-elevation-z8 table-container">
            <div class="desktop-view">
              <table mat-table [dataSource]="dataSourcePending" class="full-width-table" matSort #sortPending="matSort">
                <ng-container matColumnDef="id">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header> ID </th>
                  <td mat-cell *matCellDef="let order"> {{ order.id }} </td>
                </ng-container>
                <ng-container matColumnDef="orderDate">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header> F. Orden </th>
                  <td mat-cell *matCellDef="let order"> {{ order.orderDate | date:'dd/MM/yyyy' }} </td>
                </ng-container>
                <ng-container matColumnDef="deliveryDate">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header> F. Entrega </th>
                  <td mat-cell *matCellDef="let order"> {{ order.deliveryDate | date:'dd/MM/yyyy' }} </td>
                </ng-container>
                <ng-container matColumnDef="deliveryAddress">
                  <th mat-header-cell *matHeaderCellDef> Dirección Envío </th>
                  <td mat-cell *matCellDef="let order"> {{ order.deliveryAddress }} </td>
                </ng-container>
                <ng-container matColumnDef="paymentMethod">
                  <th mat-header-cell *matHeaderCellDef> Pago </th>
                  <td mat-cell *matCellDef="let order"> {{ order.paymentMethod }} </td>
                </ng-container>
                <ng-container matColumnDef="notes">
                  <th mat-header-cell *matHeaderCellDef> Notas </th>
                  <td mat-cell *matCellDef="let order"> {{ order.notes }} </td>
                </ng-container>
                <ng-container matColumnDef="totalAmount">
                  <th mat-header-cell *matHeaderCellDef> Total </th>
                  <td mat-cell *matCellDef="let order"> {{ order.totalAmount | currency:'USD' }} </td>
                </ng-container>
                <ng-container matColumnDef="status">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header> Estado </th>
                  <td mat-cell *matCellDef="let order">
                    <span class="estado-badge" [ngClass]="{'entregado': order.status === 'E', 'pendiente': order.status === 'P', 'cancelado': order.status === 'C'}">
                      {{ order.status === 'E' ? 'Entregado' : order.status === 'P' ? 'Pendiente' : 'Cancelado' }}
                    </span>
                  </td>
                </ng-container>
                <ng-container matColumnDef="actions">
                  <th mat-header-cell *matHeaderCellDef> Acciones </th>
                  <td mat-cell *matCellDef="let order">
                    <button mat-icon-button color="primary" (click)="editOrder(order)" matTooltip="Editar">
                      <mat-icon>edit</mat-icon>
                    </button>
                    <button mat-icon-button color="warn" (click)="deleteOrder(order.id)" matTooltip="Eliminar">
                      <mat-icon>delete</mat-icon>
                    </button>
                  </td>
                </ng-container>
                <ng-container matColumnDef="details">
                  <th mat-header-cell *matHeaderCellDef> Detalles </th>
                  <td mat-cell *matCellDef="let order">
                    <button mat-icon-button color="accent" (click)="viewDetails(order)" matTooltip="Ver Detalles">
                      <mat-icon>list_alt</mat-icon>
                    </button>
                  </td>
                </ng-container>
                <ng-container matColumnDef="report">
                  <th mat-header-cell *matHeaderCellDef> Reporte </th>
                  <td mat-cell *matCellDef="let order">
                    <button mat-icon-button color="basic" (click)="generateReport(order.id)" matTooltip="Generar Reporte PDF">
                      <mat-icon>picture_as_pdf</mat-icon>
                    </button>
                  </td>
                </ng-container>
                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
              </table>
              <mat-paginator
                [pageSizeOptions]="[5, 10, 20]"
                showFirstLastButtons
                aria-label="Selector de página"
                #paginatorPending
              ></mat-paginator>
              <div *ngIf="dataSourcePending.data.length === 0" style="padding: 20px; text-align: center">
                No hay órdenes en proceso disponibles.
              </div>
            </div>

            <div class="mobile-view">
              <div class="order-card" *ngFor="let order of dataSourcePending.data">
                <div class="card-header">
                  <span class="order-id">Orden #{{ order.id }}</span>
                  <span class="order-status" [ngClass]="{'entregado': order.status === 'E', 'pendiente': order.status === 'P', 'cancelado': order.status === 'C'}">
                    {{ order.status === 'E' ? 'Entregado' : order.status === 'P' ? 'Pendiente' : 'Cancelado' }}
                  </span>
                </div>
                <div class="card-body">
                  <div class="info-item">
                    <span class="info-label">F. Orden:</span>
                    <span class="info-value">{{ order.orderDate | date:'dd/MM/yyyy' }}</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">F. Entrega:</span>
                    <span class="info-value">{{ order.deliveryDate | date:'dd/MM/yyyy' }}</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Total:</span>
                    <span class="info-value">{{ order.totalAmount | currency:'USD' }}</span>
                  </div>
                </div>
                <div class="card-actions">
                  <button mat-button color="primary" (click)="editOrder(order)">
                    <mat-icon>edit</mat-icon> Editar
                  </button>
                  <button mat-button color="warn" (click)="deleteOrder(order.id)">
                    <mat-icon>delete</mat-icon> Eliminar
                  </button>
                  <button mat-button color="accent" (click)="viewDetails(order)">
                    <mat-icon>list_alt</mat-icon> Detalles
                  </button>
                </div>
              </div>
              <div *ngIf="dataSourcePending.data.length === 0" style="padding: 20px; text-align: center">
                No hay órdenes en proceso disponibles.
              </div>
            </div>
          </div>
        </ng-template>
      </mat-tab>
      <mat-tab label="Cancelado">
        <ng-template matTabContent>
          <div class="mat-elevation-z8 table-container">
            <div class="desktop-view">
              <table mat-table [dataSource]="dataSourceCancelled" class="full-width-table" matSort #sortCancelled="matSort">
                <ng-container matColumnDef="id">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header> ID </th>
                  <td mat-cell *matCellDef="let order"> {{ order.id }} </td>
                </ng-container>
                <ng-container matColumnDef="orderDate">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header> F. Orden </th>
                  <td mat-cell *matCellDef="let order"> {{ order.orderDate | date:'dd/MM/yyyy' }} </td>
                </ng-container>
                <ng-container matColumnDef="deliveryDate">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header> F. Entrega </th>
                  <td mat-cell *matCellDef="let order"> {{ order.deliveryDate | date:'dd/MM/yyyy' }} </td>
                </ng-container>
                <ng-container matColumnDef="deliveryAddress">
                  <th mat-header-cell *matHeaderCellDef> Dirección Envío </th>
                  <td mat-cell *matCellDef="let order"> {{ order.deliveryAddress }} </td>
                </ng-container>
                <ng-container matColumnDef="paymentMethod">
                  <th mat-header-cell *matHeaderCellDef> Pago </th>
                  <td mat-cell *matCellDef="let order"> {{ order.paymentMethod }} </td>
                </ng-container>
                <ng-container matColumnDef="notes">
                  <th mat-header-cell *matHeaderCellDef> Notas </th>
                  <td mat-cell *matCellDef="let order"> {{ order.notes }} </td>
                </ng-container>
                <ng-container matColumnDef="totalAmount">
                  <th mat-header-cell *matHeaderCellDef> Total </th>
                  <td mat-cell *matCellDef="let order"> {{ order.totalAmount | currency:'USD' }} </td>
                </ng-container>
                <ng-container matColumnDef="status">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header> Estado </th>
                  <td mat-cell *matCellDef="let order">
                    <span class="estado-badge" [ngClass]="{'entregado': order.status === 'E', 'pendiente': order.status === 'P', 'cancelado': order.status === 'C'}">
                      {{ order.status === 'E' ? 'Entregado' : order.status === 'P' ? 'Pendiente' : 'Cancelado' }}
                    </span>
                  </td>
                </ng-container>
                <ng-container matColumnDef="actions">
                  <th mat-header-cell *matHeaderCellDef> Acciones </th>
                  <td mat-cell *matCellDef="let order">
                    <button mat-icon-button color="primary" (click)="editOrder(order)" matTooltip="Editar">
                      <mat-icon>edit</mat-icon>
                    </button>
                    <button mat-icon-button color="warn" (click)="deleteOrder(order.id)" matTooltip="Eliminar">
                      <mat-icon>delete</mat-icon>
                    </button>
                  </td>
                </ng-container>
                <ng-container matColumnDef="details">
                  <th mat-header-cell *matHeaderCellDef> Detalles </th>
                  <td mat-cell *matCellDef="let order">
                    <button mat-icon-button color="accent" (click)="viewDetails(order)" matTooltip="Ver Detalles">
                      <mat-icon>list_alt</mat-icon>
                    </button>
                  </td>
                </ng-container>
                <ng-container matColumnDef="report">
                  <th mat-header-cell *matHeaderCellDef> Reporte </th>
                  <td mat-cell *matCellDef="let order">
                    <button mat-icon-button color="basic" (click)="generateReport(order.id)" matTooltip="Generar Reporte PDF">
                      <mat-icon>picture_as_pdf</mat-icon>
                    </button>
                  </td>
                </ng-container>
                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
              </table>
              <mat-paginator
                [pageSizeOptions]="[5, 10, 20]"
                showFirstLastButtons
                aria-label="Selector de página"
                #paginatorCancelled
              ></mat-paginator>
              <div *ngIf="dataSourceCancelled.data.length === 0" style="padding: 20px; text-align: center">
                No hay órdenes canceladas disponibles.
              </div>
            </div>

            <div class="mobile-view">
              <div class="order-card" *ngFor="let order of dataSourceCancelled.data">
                <div class="card-header">
                  <span class="order-id">Orden #{{ order.id }}</span>
                  <span class="order-status" [ngClass]="{'entregado': order.status === 'E', 'pendiente': order.status === 'P', 'cancelado': order.status === 'C'}">
                    {{ order.status === 'E' ? 'Entregado' : order.status === 'P' ? 'Pendiente' : 'Cancelado' }}
                  </span>
                </div>
                <div class="card-body">
                  <div class="info-item">
                    <span class="info-label">F. Orden:</span>
                    <span class="info-value">{{ order.orderDate | date:'dd/MM/yyyy' }}</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">F. Entrega:</span>
                    <span class="info-value">{{ order.deliveryDate | date:'dd/MM/yyyy' }}</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Total:</span>
                    <span class="info-value">{{ order.totalAmount | currency:'USD' }}</span>
                  </div>
                </div>
                <div class="card-actions">
                  <button mat-button color="primary" (click)="editOrder(order)">
                    <mat-icon>edit</mat-icon> Editar
                  </button>
                  <button mat-button color="warn" (click)="deleteOrder(order.id)">
                    <mat-icon>delete</mat-icon> Eliminar
                  </button>
                  <button mat-button color="accent" (click)="viewDetails(order)">
                    <mat-icon>list_alt</mat-icon> Detalles
                  </button>
                </div>
              </div>
              <div *ngIf="dataSourceCancelled.data.length === 0" style="padding: 20px; text-align: center">
                No hay órdenes canceladas disponibles.
              </div>
            </div>
          </div>
        </ng-template>
      </mat-tab>
    </mat-tab-group>
  </mat-card-content>
</mat-card>